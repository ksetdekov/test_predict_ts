# реализация тестового задания

## цель - предсказать значение clients на 31 декабря 2014 года
без ограничений, на Python

# выводы и предсказания:
Я использовал несколько подходов к предсказанию, для каждого из подходов провел кросс-валидацию временного ряда на 100 разбиениях временного ряда и сравнивал модели по метрике среднего RMSE на кросс-валидации. Для лучших моделей построил предсказания.

Использованные модели:
| Модель                      	| Random Forest регрессия                                                                                                                                          	| AR(80)                                                                                                                                        	| LSTM                                                                                                                   	| fbprophet                                                                                               	| SARIMAX                                                                                                                                                                                                          	|
|-----------------------------	|------------------------------------------------------------------------------------------------------------------------------------------------------------------	|-----------------------------------------------------------------------------------------------------------------------------------------------	|------------------------------------------------------------------------------------------------------------------------	|---------------------------------------------------------------------------------------------------------	|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|
| RMSE (CV)                   	| 20,64                                                                                                                                                            	| 20,81                                                                                                                                         	| 22,52                                                                                                                  	| 83,11                                                                                                   	| $\sim 100$ на полном наборе данных не дождался конца кросс-валидации                                                                                                                                             	|
| Короткое описание           	| Регрессор методом случайного леса на авторегрессионных переменных + экзогенные переменные                                                                        	| Авторегрессионная модель до 80-го порядка + экзогенные переменные                                                                             	| LSРекуррентная нейронная сеть, 100 нейронов в слое                                                                     	| Автоматизированная процедура с учетом сезонности                                                        	| Авторегрессионное интегрированное скользящее среднее + сезонность                                                                                                                                                	|
| Описание входящих данных    	| Значение clients с лагом 1-48 часов, значение часа, месяца, дня месяца, флаг последнего дня месяца, минимум, среднее и максимум clients за прошлые 24 и 48 часов 	| Значение clients, значение часа, месяца, дня месяца, флаг последнего дня месяца, минимум, среднее и максимум clients за прошлые 24 и 48 часов 	| Значение clients, часа, месяца, дня месяца, флаг последнего дня месяца, минимум и максимум clients за прошлые 48 часов 	| Только clients и флаг                                                                                   	| Только clients и параметры модели                                                                                                                                                                                	|
| ссылка на прогноз           	| [rf_predict.csv](https://github.com/ksetdekov/test_predict_ts/blob/main/rf_predict.csv)                                                                          	| [ar_predict.csv](https://github.com/ksetdekov/test_predict_ts/blob/main/ar_predict.csv)                                                       	|                                                                                                                        	| [fbpredict.csv](https://github.com/ksetdekov/test_predict_ts/blob/main/fbpredict.csv)                   	|                                                                                                                                                                                                                  	|
| ссылка на реализацию в коде 	| [раздел Random forest](https://github.com/ksetdekov/test_predict_ts/blob/main/analysis_and_fx_arima_and_rf.ipynb)                                                	| [раздел AR](https://github.com/ksetdekov/test_predict_ts/blob/main/analysis_and_fx_arima_and_rf.ipynb)                                        	| [LSTM](https://github.com/ksetdekov/test_predict_ts/blob/main/LSTM.ipynb)                                              	| [fbprophet + exploratory](https://github.com/ksetdekov/test_predict_ts/blob/main/analysis_and_fx.ipynb) 	| [поиск параметров](https://github.com/ksetdekov/test_predict_ts/blob/main/sarimax_grid_search.ipynb) [раздел Sarimax](https://github.com/ksetdekov/test_predict_ts/blob/main/analysis_and_fx_arima_and_rf.ipynb) 	|


## todo:
* добавить обучение лучшего sarimax на всех данных
* потенциально добавить перебор гиперпараметров sarimax

* сделать ltsm
    * rmse cv
